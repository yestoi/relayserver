<!DOCTYPE html>
<html>
	<head>
		<link href="css/style.css" rel="stylesheet">
		<link href="css/jquery.sidr.dark.css" rel="stylesheet">
		<script type="text/javascript" src="//code.jquery.com/jquery-1.6.1.min.js"></script>
		<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/0.9.16/socket.io.min.js"></script>
		<script type="text/javascript" src="js/jquery.nested.js"></script>
		<script type="text/javascript" src="js/jquery.sidr.js"></script>
		<script type="text/javascript" src="js/makeboxes.js"></script>
<script> 
$(document).ready(function() {
	$("#sessions").nested({
		gutter: 5,
		minWidth: 75,
		resizeToFit: false,
		animate: false,
		animationOptions: {
			speed: 300,
			duration: 200,
			queue: false 
		}
	});

	$('#menu').sidr({displace: false});
	$.sidr('open', 'sidr');

	$('.invisible').hide(); 
	$('#init').remove();

	var socket = io.connect('http://' + document.domain + ':' + location.port + '/sessions');

	var sess = [];
	socket.on('session_data', function(data) {
		for (var key in data) {
			if (data.hasOwnProperty(key)) {
				var keyid = key.replace(/\./g, "-");
				var title = key.replace("--", " -> ");

				if ($.inArray(keyid, sess) > -1) {
					$("#" + keyid).empty();
					$("#" + keyid).append("<H2>" + title + "</H2>");
					$("#" + keyid).append("<pre>" + data[key] + "</pre>");
				}
				else {
					var box = makeBoxes(1, 54, keyid);
					$('#sessions').append(box).nested('append', box);
					sess.push(keyid);
				}
			}
		}
	});


	$("#sidr ul li .teams").click(function() {
		$("#sessions").hide();
		$("#sidr ul li .sessions").removeClass("active");
		$("#teams").show();
		$("#sidr ul li .teams").addClass("active");
	});

});


</script>
	</head>

<body>
	<a id="menu" href="#sidr" class="invisible"></a> <!-- Horrible hack -->
	<div id="sidr">
		<ul>
			<li class="teams"><a href="#">Teams</a></li>
			<li class="active sessions"><a href="#">Sessions</a></li>
			<li class="relays"><a href="#">Relays</a></li>
			<li class="jobs"><a href="#">Jobs</a></li>
		</ul>
	</div>

	<div id="sessions">
		<div id="init" class="box size44"></div>
	</div>

	<div id="teams" class="invisible">
		<figure></figure>
	</div>
</body>
</html>
